<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title></title>
    <script src="js/mui.min.js"></script>
    <link href="css/mui.min.css" rel="stylesheet"/>
    <script type="text/javascript" charset="utf-8">
      	mui.init();
    </script>
</head>
<body>
	<div class="mui-title">课程签到</div>
		
	<br  /> <br  /> <br  /> 
	
	<form class="mui-input-group">
					<div class="mui-input-row">
						<label>课程号：</label>
						<input type="text" placeholder="输入课程号，例：3" id="inputSignTest" />
					</div>
					<div class="mui-input-row">
						<label>手机码：</label>
						<input type="text" class="mui-input-clear" placeholder="可以不输入" id="inputPhoneID" />
					</div>
	</form>
	
	<div class="mui-content">
			<div class="mui-content-padded" style="margin: 5px;text-align: center;">
				<br />
				<div id="info"></div>
				<br />
				<div id="phoneID"></div>
				<br />
				<button id='signBtn' type="button" class="mui-btn mui-btn-blue mui-btn-outlined">签到</button>	
			</div>
			<br /><br /><br />
			<div style="color: gray;bottom:0px;left: 50%;text-align: center;">developed by yutaoma</div>
	</div>
	
</body>

<script src="js/mui.min.js"></script>
	<script src="js/lixin.js"></script>
	<script type="text/javascript" charset="utf-8">
      	mui.init();
      	var classNumber;
      	var plusuuid;
  	    phoneID.innerText = "签到的手机：" + plus.device.uuid;
		
		document.getElementById("inputSignTest").addEventListener('input',function(){
			classNumber = this.value;
			console.log(this.value);
			info.innerText = "签到的课程是：" + this.value;
		});
		
		document.getElementById("inputPhoneID").addEventListener('input',function(){
			console.log(this.value);
			if (this.value == "") {
				phoneID.innerText = "签到的手机：" + plus.device.uuid;
				plusuuid = plus.device.uuid;
			} else {
				phoneID.innerText = "签到的手机：" + this.value ;
				plusuuid = this.value;
			}
			
		});

      	function roll(tableID,plusuuid) {
//    		mui.toast("考勤成功！");
      		var postdata="";
			postdata += "std_openid="+plusuuid;
			myxhr(LogByJsonStr,urlroot+"json.asp?"+tableID,postdata);
      	};
      	
      	//签到 button 方法
		document.getElementById("signBtn").addEventListener('tap', function(e) {
				if (classNumber.startsWith('j')) {
					console.log("复杂的签到");
					roll(classNumber,plusuuid);
				} else {
					console.log("简单的签到：" + classNumber);
					roll("j=s_ls"+classNumber,plusuuid)
				}
		});	
		
   </script>
</html>